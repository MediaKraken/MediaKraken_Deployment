{% extends "layout.html" %}
{% block content %}
<body id="data_background">
<head>
    <meta charset="UTF-8"/>
    <link rel="stylesheet"
          href="{{ url_for('static', filename='bootstrap/css/bootstrap.min.css') }}">
    <link rel="stylesheet"
          href="{{ url_for('static', filename='font-awesome/css/font-awesome.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/star-rating.min.css') }}"
          media="all" type="text/css"/>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base_webapp_layout.css') }}"
          media="all" type="text/css"/>
    <link rel="stylesheet" href="{{ url_for('static', filename='fancytree/skin-bootstrap/ui.fancytree.min.css') }}">
    <script type="text/javascript">
        $(function () {
            $("#tree").fancytree({
                onActivate: function (node) {
                    // A DynaTreeNode object is passed to the activation handler
                    // Note: we also get this event, if persistence is on, and the
                    // page is reloaded.
                    alert("You activated " + node.data.title);
                },
                source: [ // Pass an array of nodes.
                {% for stream_uuid in data_ffprobe_data %}
                    { title: "{{data_ffprobe_data[stream_uuid][0] + ' ' + data_ffprobe_data[stream_uuid][1]}}", isFolder: true, expanded: true,
                        children: [
                            { title: "Audio Stream(s):", isFolder: true, expanded: true,
                                children: [
                                    {% for audio_stream in data_ffprobe_data[stream_uuid][2] %}
                                        { title: "{{audio_stream[0] + ' ' + audio_stream[1]}}" },
                                    {% endfor %}
                                ]
                            },
                            {% if data_ffprobe_data[stream_uuid][3]|length > 0 %}
                                { title: "Subtitle(s):", isFolder: true, expanded: true,
                                    children: [
                                        {% for subtitle_stream in data_ffprobe_data[stream_uuid][3] %}
                                            { title: "{{subtitle_stream}}" },
                                        {% endfor %}
                                    ]
                                },
                            {$ endif %}
                        ]
                    },
                {% endfor %}
                ]
            });
        });
    </script>
    <style>
        body {
          padding-top: 100px;
        }
        @media (max-width: 980px) {
            body {
              padding-top: 0;
            }
        }
    </style>
</head>
{% if json_metadata %}
<div id="movie_detail">
    {% if data_background_image is none %}
    <img alt="fs_bg_image" src="{{ url_for('static', filename='images/movie_ticket.png') }}" id="fs_bg_image">
    {% else %}
    <img alt="fs_bg_image" src="{{ url_for('static', filename='meta/images/' + data_background_image | replace('/mediakraken/web_app/MediaKraken/static/meta/images/', '')) }}" id="fs_bg_image">
    {% endif %}
    <form name="video_play_stat_form" method="post">
        <div class="row">
            <div class="col-sm-2">
                <div id="movie_image_div" class="table-responsive">
                    {% if data_poster_image is none %}
                    <img class="center" src="{{ url_for('static', filename='images/Movie-icon.png') }}">
                    {% else %}
                    <img class="center" src="{{ url_for('static', filename='meta/images/' + data_poster_image | replace('/mediakraken/web_app/MediaKraken/static/meta/images/', '')) }}">
                    {% endif %}
                </div>
            </div>
            <div class="col-sm">
                <div class="row">
                    <div class="col-sm">
                        <div id="tree">
                        </div>
                    </div>
                    <div class="col-sm">
                        <ul class="list-group">
                            {% for playback_device in data_playback_device %}
                                <li class="list-group-item">{{playback_device}}
                                </li>
                            {% endfor %}
                            <li class="list-group-item">Web Viewer
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="row">
                    <div id="movie_detail_div" class="table-responsive">
                        <div id="textbox">
                            <p class="alignleft">Title: {{json_metadata['mm_metadata_json']['Meta']['themoviedb']['Meta']['title']}}</p>
                            <p class="alignright">Release Date:
                                {{json_metadata['mm_metadata_json']['Meta']['themoviedb']['Meta']['release_date']}}</p>
                        </div>
                        <div style="clear: both;"></div>
                        <div id="tag_title">
                            {% if json_metadata['mm_metadata_json']['Meta']['themoviedb']['Meta']['tagline'] and
                            json_metadata['mm_metadata_json']['Meta']['themoviedb']['Meta']['tagline'] != '-' %}
                            <BR><p>{{json_metadata['mm_metadata_json']['Meta']['themoviedb']['Meta']['tagline']}}</p>
                            {% endif %}
                            {% if json_metadata['mm_metadata_json']['Meta']['themoviedb']['Meta']['original_title'] and
                            json_metadata['mm_metadata_json']['Meta']['themoviedb']['Meta']['original_title'] != json_metadata['mm_metadata_json']['Meta']['themoviedb']['Meta']['title'] %}
                            <BR><p>Alternate Title:
                                {{json_metadata['mm_metadata_json']['Meta']['themoviedb']['Meta']['original_title']}}</p>
                            {% endif %}
                        </div>
                        <div style="clear: both;"></div>
                        <div id="textbox_gen">
                           <BR><p class="alignleft"><input id="movie_rating_stars"
                                                         value={{json_metadata['mm_metadata_json']['Meta']['themoviedb']['Meta']['vote_average']}}
                                                         type="number" class="rating" min=0 max=10
                                                         step=0.1
                                                         data-size="xx" data-stars="10"></p>
                            {% for genre in data_genres %}
                            <button type="button" class="btn">{{genre}}</button>
                            {% endfor %}
                            <p class="alignright">
                                {% if data_watched_status == True %}
                                <input class="btn btn-default btn-submit" type="submit"
                                       name="status"
                                       value="Watched">
                                {% else %}
                                <input class="btn btn-default btn-submit" type="submit"
                                       name="status"
                                       value="Unwatched">
                                {% endif %}
                                {% if data_sync_status == False %}
                                <input class="btn btn-default btn-submit" type="submit"
                                       name="status"
                                       value="Sync">
                                {% endif %}
                            </p>
                            {% if json_metadata['mm_metadata_json']['Meta']['themoviedb']['Meta']['homepage'] %}
                            <p>Homepage: <a href={{json_metadata['mm_metadata_json']['Meta']['themoviedb']['Meta']['homepage']}}>{{json_metadata['mm_metadata_json']['Meta']['themoviedb']['Meta']['homepage']}}</a>
                            </p>
                            {% endif %}
                        </div>
                        <div style="clear: both;"></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="card">
                <div class="card-header">
                    Overview
                </div>
                <div class="card-body">
                    <p class="card-text">
                        {{json_metadata['mm_metadata_json']['Meta']['themoviedb']['Meta']['overview']}}
                    <p>
                </div>
            </div>
        </div>
        {% if data_json_media_chapters %}
        <div class="row">
            <div class="card">
                <div class="card-header">
                    Chapters
                </div>
                <div class="card-body">
                    <p class="card-text">
                    <div class="grid">
                        {% for chapter_info in data_json_media_chapters %}
                        <div class="col-1-4">
                            <a href="{{ url_for('user_playback.user_video_player_videojs', mtype='hls', guid=data_guid, chapter=chapter_info[0].replace(' ','%20'), audio=0, sub=0) }}">
                                <img class="b-lazy"
                                     src=data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==
                                     data-src="{{ url_for('static', filename='meta/images/' + chapter_info[1] | replace('/mediakraken/web_app/MediaKraken/static/meta/images/', '')) }}"
                                     height="150" width="150">
                            </a>
                        </div>
                        {% endfor %}
                    </div>
                    <p>
                </div>
            </div>
        </div>
        {% endif %}
    </form>
</div>
{% else %}
<p>No info found. ERROR! You should never see this message.</p>
{% endif %}
<script src="{{ url_for('static', filename='bootstrap/js/bootstrap.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/jquery.min.js') }}" type="text/javascript"></script>
<script src="{{ url_for('static', filename='js/jquery-ui.min.js') }}" type="text/javascript"></script>
<script src="{{ url_for('static', filename='js/star-rating.min.js') }}" type="text/javascript"></script>
<script src="{{ url_for('static', filename='js/blazy.min.js') }}"></script>
<script src="{{ url_for('static', filename='fancytree/jquery.fancytree-all-deps.min.js') }}"></script>
<script src="{{ url_for('static', filename='fancytree/modules/jquery.fancytree.ui-deps.js') }}"></script>
<script>
    ;(function() {
        // Initialize
        var bLazy = new Blazy();
    })();
</script>
</body>
{% endblock %}
