{% extends "layout.html" %}
{% block content %}
<body id="data_background">
<head>
    <meta charset="UTF-8"/>
    <link rel="stylesheet" href="{{ url_for('static', filename='bootstrap/css/bootstrap.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/star-rating.min.css') }}" media="all" type="text/css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base_webapp_layout.css') }}" media="all" type="text/css">
    <style>
        body {
          padding-top: 100px;
        }
        @media (max-width: 980px) {
            body {
              padding-top: 0;
            }
        }
    </style>
</head>
{% if json_metadata %}
<div id="movie_detail">
    {% if data_background_image is none %}
    <img alt="fs_bg_image" src="{{ url_for('static', filename='images/movie_ticket.png') }}">
    {% else %}
    <img alt="fs_bg_image" src="{{ url_for('static', filename='meta/images/' + data_background_image | replace('/mediakraken/web_app/MediaKraken/static/meta/images/', '')) }}">
    {% endif %}
    <form name="video_play_stat_form" method="post">
        <div class="row">
            <div class="col-sm-2">
                <div class="table-responsive">
                    {% if data_poster_image is none %}
                    <img class="center" src="{{ url_for('static', filename='images/Movie-icon.png') }}">
                    {% else %}
                    <img class="center" src="{{ url_for('static', filename='meta/images/' + data_poster_image | replace('/mediakraken/web_app/MediaKraken/static/meta/images/', '')) }}">
                    {% endif %}
                </div>
            </div>
            <div class="col-sm">
                <div class="row">
                    <div class="col-sm">
                        <div class="card">
                            <div class="card-header">
                                Media Version(s)
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-striped table-hover">
                                        <thead>
                                        <tr>
                                            <th>Resolution</th>
                                            <th>Runtime</th>
                                            <th>Audio</th>
                                            <th>Subtitle</th>
                                            <th>Device</th>
                                            <th>Playback</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                            {% for stream_uuid in data_ffprobe_data %}
                                                <tr>
                                                    <td>{{data_ffprobe_data[stream_uuid][0]}}</td>
                                                    <td>{{data_ffprobe_data[stream_uuid][1]}}</td>
                                                    <td>
                                                        <select name={{"audio|" + loop.index|string }} >
                                                            {% for audio_stream in data_ffprobe_data[stream_uuid][2] %}
                                                                <option value="{{loop.index|string}}">{{audio_stream[2] + ' (' + audio_stream[0] + ') ' + audio_stream[1]}}</option>
                                                            {% endfor %}
                                                        </select>
                                                    </td>
                                                    <td>
                                                        <select name={{"subtitle|" + loop.index|string }} >
                                                            <option value="None">None</option>
                                                            {% if data_ffprobe_data[stream_uuid][3]|length > 0 %}
                                                                {% for subtitle_stream in data_ffprobe_data[stream_uuid][3] %}
                                                                    <option value="{{loop.index|string}}">{{subtitle_stream}}</option>
                                                                {% endfor %}
                                                            {% endif %}
                                                        </select>
                                                    </td>
                                                    <td>
                                                        <select name={{"playback_device|" + loop.index|string }} >
                                                            <option value="web_viewer">Web Viewer</option>
                                                            {% for playback_device in data_playback_device %}
                                                                <option value="{{loop.index|string}}">{{playback_device}}</option>
                                                            {% endfor %}
                                                        </select>
                                                    </td>
                                                    <td>
                                                        <a href= "{{ url_for('user_playback.user_playback', action='play', guid=stream_uuid, device=1) }}" id={{"play_button|" + loop.index|string}}>
                                                            <img class="b-lazy" src=data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== data-src="{{ url_for('static', filename='images/navigation/play.png') }}" height="20" width="20">
                                                        </a>
                                                    </td>
                                                </tr>
                                            {% endfor %}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="table-responsive">
                        <p>
                            <span style="float: left">Title: {{json_metadata['mm_metadata_json']['Meta']['themoviedb']['Meta']['title']}}</span>
                            <span style="float: right">Release Date: {{json_metadata['mm_metadata_json']['Meta']['themoviedb']['Meta']['release_date']}}</span>
                        </p>
                    </div>
                    {% if json_metadata['mm_metadata_json']['Meta']['themoviedb']['Meta']['tagline'] and
                    json_metadata['mm_metadata_json']['Meta']['themoviedb']['Meta']['tagline'] != '-' %}
                    <p>{{json_metadata['mm_metadata_json']['Meta']['themoviedb']['Meta']['tagline']}}</p>
                    {% endif %}
                    {% if json_metadata['mm_metadata_json']['Meta']['themoviedb']['Meta']['original_title'] and
                    json_metadata['mm_metadata_json']['Meta']['themoviedb']['Meta']['original_title'] != json_metadata['mm_metadata_json']['Meta']['themoviedb']['Meta']['title'] %}
                    <p>Alternate Title: {{json_metadata['mm_metadata_json']['Meta']['themoviedb']['Meta']['original_title']}}</p>
                    {% endif %}
                    <BR>
                    {% for genre in data_genres %}
                    <button type="button" class="btn">{{genre}}</button>
                    {% endfor %}
                    <p>
                        {% if data_watched_status == True %}
                        <input class="btn btn-default btn-submit" type="submit"
                               name="status"
                               value="Watched">
                        {% else %}
                        <input class="btn btn-default btn-submit" type="submit"
                               name="status"
                               value="Unwatched">
                        {% endif %}
                        {% if data_sync_status == False %}
                        <input class="btn btn-default btn-submit" type="submit"
                               name="status"
                               value="Sync">
                        {% endif %}
                    </p>
                    {% if json_metadata['mm_metadata_json']['Meta']['themoviedb']['Meta']['homepage'] %}
                    <p>Homepage: <a href={{json_metadata['mm_metadata_json']['Meta']['themoviedb']['Meta']['homepage']}}>{{json_metadata['mm_metadata_json']['Meta']['themoviedb']['Meta']['homepage']}}</a></p>
                    {% endif %}
                    <p><input id="movie_rating_stars" class="rating rating-loading" value="{{json_metadata['mm_metadata_json']['Meta']['themoviedb']['Meta']['vote_average']}}" data-min="0" data-max="10" data-step="0.5" data-size="md"></p>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="card">
                <div class="card-header">
                    Overview
                </div>
                <div class="card-body">
                    <p class="card-text">{{json_metadata['mm_metadata_json']['Meta']['themoviedb']['Meta']['overview']}}<p>
                </div>
            </div>
        </div>
        {% if data_json_media_chapters %}
        <div class="row">
            <div class="card">
                <div class="card-header">
                    Chapters
                </div>
                <div class="card-body">
                    <p class="card-text">
                    <div class="grid">
                        {% for chapter_info in data_json_media_chapters %}
                        <div class="col-1-4">
                            <a href="{{ url_for('user_playback.user_video_player_videojs', mtype='hls', guid=data_guid, chapter=chapter_info[0].replace(' ','%20'), audio=0, sub=0) }}">
                                <img class="b-lazy"
                                     src=data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==
                                     data-src="{{ url_for('static', filename='meta/images/' + chapter_info[1] | replace('/mediakraken/web_app/MediaKraken/static/meta/images/', '')) }}"
                                     height="150" width="150">
                            </a>
                        </div>
                        {% endfor %}
                    </div>
                    <p>
                </div>
            </div>
        </div>
        {% endif %}
    </form>
</div>
{% else %}
<p>No info found. ERROR! You should never see this message.</p>
{% endif %}
<script src="{{ url_for('static', filename='bootstrap/js/bootstrap.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/jquery.min.js') }}" type="text/javascript"></script>
<script src="{{ url_for('static', filename='js/star-rating.min.js') }}" type="text/javascript"></script>
<script src="{{ url_for('static', filename='js/blazy.min.js') }}"></script>
<script>
    ;(function() {
        // Initialize
        var bLazy = new Blazy();
    })();
</script>
</body>
{% endblock %}
